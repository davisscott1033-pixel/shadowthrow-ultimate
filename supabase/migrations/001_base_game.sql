create table if not exists public.matches (id uuid primary key default gen_random_uuid(), state text default 'active', created_at timestamptz default now()); create table if not exists public.rounds (id uuid primary key default gen_random_uuid(), match_id uuid not null, index int not null, state text default 'commit'); create table if not exists public.commits (round_id uuid, user_id text, hash text, primary key (round_id, user_id)); create table if not exists public.reveals (round_id uuid, user_id text, choice text, salt text, primary key (round_id, user_id)); create table if not exists public.events (id uuid primary key default gen_random_uuid(), event_key text not null, props jsonb default '{}'::jsonb, created_at timestamptz default now()); create table if not exists public.rules_audit (id uuid primary key default gen_random_uuid(), occurred_at timestamptz default now(), user_id text, rule_key text, action text, payload jsonb default '{}'::jsonb);